# System Files Directory

This directory contains system-level configuration files that are layered onto the container image during the build process.

## Directory Structure

The files are organized by desktop environment to maintain clean separation of concerns:

```
system_files/
├── shared/          # Configuration files used by both GNOME and KDE
├── gnome/           # GNOME-specific configuration files
├── kde/             # KDE-specific configuration files
└── README.md        # This file
```

## Build Order

The Containerfile copies files in this order:
1. **shared/** - General system configurations applied first
2. **gnome/** - GNOME overrides and specific settings
3. **kde/** - KDE overrides and specific settings

This ensures that desktop-specific settings take precedence over shared defaults.

## File Paths

Configuration files should maintain their full system paths:

```
kde/etc/xdg/kglobalshortcutsrc → /etc/xdg/kglobalshortcutsrc
gnome/etc/dconf/profile/user    → /etc/dconf/profile/user
shared/etc/profile.d/custom.sh  → /etc/profile.d/custom.sh
```

## Adding New Configuration Files

When adding a new configuration file:

1. Create the full directory structure under `shared/`, `gnome/`, or `kde/`
2. Use the system-absolute path (e.g., `kde/etc/xdg/kdeglobals`)
3. Add a comment to the file explaining its purpose
4. Test the configuration by building and booting the image

## KDE Configuration Files

Currently implemented:

- `kde/etc/xdg/kglobalshortcutsrc` - Keyboard shortcuts (Ctrl+Alt+T for Ptyxis terminal)
- `kde/etc/xdg/kdeglobals` - Global KDE settings (theme, font, defaults)

Future additions:
- `kde/etc/xdg/plasmashellrc` - Taskbar and desktop layout
- `kde/etc/xdg/kdedefaults/` - KDE Framework defaults
- `kde/usr/share/backgrounds/` - Desktop wallpapers

## GNOME Configuration Files

Currently: None (inherits Bazzite GNOME defaults)

Future additions:
- `gnome/etc/dconf/profile/user` - dconf settings database
- `gnome/etc/dconf/db/local.d/` - dconf database entries
- `gnome/usr/share/backgrounds/` - Desktop wallpapers

## Shared Configuration Files

Currently: None (system configuration handled by scripts)

Future additions:
- `shared/etc/profile.d/` - System-wide environment variables
- `shared/etc/default/` - System service defaults

## Testing Configuration Files

To test if your configuration file works:

1. Build the image: `just build`
2. Create a VM: `just build-qcow2`
3. Boot the VM: `just run-vm-qcow2`
4. Log into the appropriate desktop (KDE or GNOME)
5. Verify the setting is applied

## Documentation

For more information on configuring:

- **KDE Plasma**: https://userbase.kde.org/Plasma/Configuring
- **GNOME**: https://wiki.gnome.org/Admin/Configuration
- **Bazzite**: https://docs.bazzite.gg/

## Notes

- Files are copied using `cp -r`, preserving directory structure and permissions
- Binary configuration files (like dconf databases) should be generated by scripts, not checked in
- Keep shared configurations minimal to avoid conflicts
- Test both desktops when changing shared settings
